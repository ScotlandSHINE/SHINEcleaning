test_that("test data get parsed correctly", {
  data_path <- "raw_data/sec_test_cluster.csv"
  result <- parse_raw_csv(data_path)

  expected <- tibble::tibble(
    StartDate = c("2024-08-25 15:15:23"),
    EndDate = c("2024-08-25 15:15:23"),
    Status = c("Survey Test"),
    Progress = c("100"),
    `Duration (in seconds)` = c("0"),
    Finished = c("True"),
    completed_date = c("2024-08-25"),
    RecordedDate = c("2024-08-25 15:15:23"),
    ResponseId = c("R_8nLE4rPRdLBce1w"),
    DistributionChannel = c("test"),
    UserLanguage = c(na_chr),
    consent = c("Yes, I am happy to take part"),
    class = c("Prefer not to say"),
    sex = c("Female"),
    gender = c("Prefer not to say"),
    dobmnth = c("May"),
    dobday = c("21"),
    dobyr = c("2005"),
    health = c("Prefer not to say"),
    who1 = c("More than half of the time"),
    who2 = c("Most of the time"),
    who3 = c("Some of the time"),
    who4 = c("Most of the time"),
    who5 = c("At no time"),
    lifesat1 = c("Prefer not to say"),
    lifesat2 = c("3"),
    lifesat3 = c("Prefer not to say"),
    lifesat4 = c("Prefer not to say"),
    lifesat5 = c("9"),
    lifesat6 = c("3"),
    lifesat7 = c("0"),
    lifesat8 = c("5"),
    lifesat9 = c("0"),
    lifesat10 = c("10"),
    lifesat11 = c("3"),
    asw1 = c("Once in a while"),
    asw2 = c("Sometimes"),
    asw3 = c("Prefer not to say"),
    asw4 = c("Never"),
    asw5 = c("Frequently, if not always"),
    asw6 = c("Once in a while"),
    asw7 = c("Never"),
    asw8 = c("Frequently, if not always"),
    asw9 = c("Sometimes"),
    asw10 = c("Frequently, if not always"),
    loneliness = c("Most of the time"),
    sdq1 = c("Certainly true"),
    sdq2 = c("Not true"),
    sdq3 = c("Somewhat true"),
    sdq4 = c("Not true"),
    sdq5 = c("Somewhat true"),
    sdq6 = c("Somewhat true"),
    sdq7 = c("Certainly true"),
    sdq8 = c("Somewhat true"),
    sdq9 = c("Certainly true"),
    sdq10 = c("Certainly true"),
    sdq11 = c("Somewhat true"),
    sdq12 = c("Somewhat true"),
    sdq13 = c("Somewhat true"),
    sdq14 = c("Not true"),
    sdq15 = c("Not true"),
    sdq16 = c("Certainly true"),
    sdq17 = c("Not true"),
    sdq18 = c("Certainly true"),
    sdq19 = c("Somewhat true"),
    sdq20 = c("Certainly true"),
    sdq21 = c("Certainly true"),
    sdq22 = c("Somewhat true"),
    sdq23 = c("Not true"),
    sdq24 = c("Certainly true"),
    sdq25 = c("Not true"),
    selfh1 = c(na_chr),
    selfh2 = c(na_chr),
    sch1 = c("Prefer not to say"),
    sch2 = c("Not at all"),
    sch3 = c("Always"),
    sehss1 = c("Prefer not to say"),
    sehss2 = c("A little true of me"),
    sehss3 = c("Very much true of me"),
    sehss4 = c("Prefer not to say"),
    sehss5 = c("A little true of me"),
    sehss6 = c("Not at all true of me"),
    sehss7 = c("A little true of me"),
    sehss8 = c("A little true of me"),
    sehss9 = c("A little true of me"),
    sehss10 = c("Very much true of me"),
    sehss11 = c("Prefer not to say"),
    sehss12 = c("Very much true of me"),
    sehss13 = c("A little true of me"),
    sehss14 = c("Prefer not to say"),
    sehss15 = c("A little true of me"),
    sehss16 = c("Very much true of me"),
    sehss17 = c("Prefer not to say"),
    sehss18 = c("Prefer not to say"),
    sehss19 = c("Very much true of me"),
    sehss20 = c("Very much true of me"),
    sehss21 = c("Pretty much true of me"),
    sehss22 = c("Pretty much true of me"),
    sehss23 = c("Prefer not to say"),
    sehss24 = c("Not at all true of me"),
    sehss25 = c("Very much true of me"),
    sehss26 = c("Very much true of me"),
    sehss27 = c("Prefer not to say"),
    sehss28 = c("Prefer not to say"),
    sehss29 = c("Very much true of me"),
    sehss30 = c("Prefer not to say"),
    fas1 = c("Prefer not to say"),
    fas2 = c("No"),
    fas3 = c("Two"),
    fas4 = c("Once"),
    fas5 = c("Prefer not to say"),
    fas6 = c("Prefer not to say"),
    postcode = c("Don't know postcode"),
    postcode_5_TEXT = c(na_chr),
    Activity_4 = c("Hanging out with friends"),
    Activity_5 = c("Chatting/messaging friends on phone or computer"),
    Activity_6 = c("Doing a physical activity or sport"),
    Activity_7 = c("Outdoor activities (playing, walking, cycling etc)"),
    Activity_8 = c("Watching TV/film"),
    Activity_9 = c("Playing computer games"),
    Activity_10 = c("Reading"),
    Activity_11 = c("Going on the internet"),
    Activity_17 = c(na_chr),
    Activity_19 = c("Creative arts (drama, dance, music)"),
    `Local Authority` = c("XX"),
    `School name` = c(na_chr),
    SchID = c("XX1234"),
    `Create New Field or Choose From Dropdown...` = c(na_chr),
    `School ID code` = c(na_chr),
    Email = c(na_chr)
  )

  expect_equal(head(result, 1), expected)
})
