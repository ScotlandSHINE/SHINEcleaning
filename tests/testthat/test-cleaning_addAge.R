test_that("Age is calculated correctly", {

  test_data <- tibble::tribble(
    ~record_date, ~dobyr, ~dobmnth, ~dobday,
    "2024-11-01 22:00:00", 2014, 1,  10,
    "2024-11-01 22:00:00", 2014, 2,  10,
    "2024-11-01 22:00:00", 2013, 3,  10,
    "2024-11-01 22:00:00", 2013, 4,  10,
    "2024-11-01 22:00:00", 2012, 5,  20,
    "2024-11-01 22:00:00", 2012, 6,  20,
    "2024-11-01 22:00:00", 2010, 7,  20,
    "2024-11-01 22:00:00", 2010, 8,  20,
    "2024-11-01 22:00:00", 2010, 9,  1,
    "2024-11-01 22:00:00", 2010, 10, 31,
    "2024-11-01 22:00:00", 2009, 11, 2,
    "2024-11-01 22:00:00", 2009, 11, 1,
    "2024-11-01 22:00:00", 2009, 12, 1
  )

  expected_ages <- c(10.81, 10.72, 11.65, 11.56, 12.45, 12.37, 14.29, 14.20, 14.17, 14.00, 15.00, 15.00, 14.92)

  result_age <- do.call(calculate_age, test_data)

  expect_equal(result_age, expected_ages)

})
